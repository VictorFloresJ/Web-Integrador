{"version":3,"sources":["carrito.js"],"names":["limpiarPrecio","precioStr","limpio","replace","trim","parseFloat","obtenerCookies","cookies","document","cookie","split","carritoElemento","querySelector","subtotal","forEach","nombre","valor","startsWith","producto","JSON","parse","decodeURIComponent","console","table","precio","productoElemento","createElement","classList","add","id","plataforma","innerHTML","imagen","titulo","appendChild","mostrarTotales","fetch","then","response","json","data","contenedorTotales","toFixed","tasa_iva","iva","total","pais","catch","error","addEventListener"],"mappings":"AAEA,SAASA,cAAcC,GACnB,IAAIC,EAASD,EAAUE,QAAQ,IAAK,IAAIC,OAGxC,OAFAF,EAASA,EAAOC,QAAQ,KAAM,IAEvBE,WAAWH,GAGtB,SAASI,iBACL,MAAMC,EAAUC,SAASC,OAAOC,MAAM,KAChCC,EAAkBH,SAASI,cAAc,sBAC/C,IAAIC,EAAW,EAEfN,EAAQO,SAAQ,SAAUL,GACtB,IAAKM,EAAQC,GAASP,EAAOC,MAAM,KAGnC,GAFAK,EAASA,EAAOX,OAEZW,EAAOE,WAAW,aAAc,CAChC,MAAMC,EAAWC,KAAKC,MAAMC,mBAAmBL,IAE/CM,QAAQC,MAAML,GAEdL,GAAYb,cAAckB,EAASM,QAEnC,MAAMC,EAAmBjB,SAASkB,cAAc,OAChDD,EAAiBE,UAAUC,IAAI,qBAAsB,oBACrDH,EAAiBI,GAAK,GAAGX,EAASW,MAAMX,EAASY,aAEjDL,EAAiBM,UAAY,2FAEFb,EAASc,mKAGId,EAASe,yEACFf,EAASM,oEACbN,EAASY,4DACrBZ,EAASW,MAAMX,EAASY,wGACtBZ,EAASW,MAAMX,EAASY,kqBAalCZ,EAASW,MAAMX,EAASY,8LAO/CnB,EAAgBuB,YAAYT,OAIpCU,eAAetB,GAGnB,SAASsB,eAAetB,GACpBuB,MAAM,2BAA2BvB,GAC5BwB,KAAKC,GAAYA,EAASC,QAC1BF,KAAKG,IACF,MAAMC,EAAoBjC,SAASI,cAAc,uBAC5C6B,IAELA,EAAkBV,UAAY,mCACVlB,EAAS6B,QAAQ,oCACN,IAAhBF,EAAKG,UAAgBD,QAAQ,UAAUF,EAAKI,IAAIF,QAAQ,8CAC9CF,EAAKK,MAAMH,QAAQ,8DACZF,EAAKM,oCAGxCC,MAAMC,IACH1B,QAAQ0B,MAAM,yBAA0BA,KAhFpDxC,SAASyC,iBAAiB,mBAAoB3C","file":"carrito.js","sourcesContent":["document.addEventListener('DOMContentLoaded', obtenerCookies);\r\n\r\nfunction limpiarPrecio(precioStr) {\r\n    let limpio = precioStr.replace('$', '').trim();   // Quitar signo $\r\n    limpio = limpio.replace(/,/g, '');                 // Quitar comas de miles\r\n    // parseFloat lee hasta donde puede, ignora texto extra (ej. \"MXN\")\r\n    return parseFloat(limpio);\r\n}\r\n\r\nfunction obtenerCookies() {\r\n    const cookies = document.cookie.split(';');\r\n    const carritoElemento = document.querySelector('.compras_productos');\r\n    let subtotal = 0;\r\n\r\n    cookies.forEach(function (cookie) {\r\n        let [nombre, valor] = cookie.split('=');\r\n        nombre = nombre.trim();\r\n\r\n        if (nombre.startsWith('producto_')) {\r\n            const producto = JSON.parse(decodeURIComponent(valor));\r\n\r\n            console.table(producto);\r\n\r\n            subtotal += limpiarPrecio(producto.precio); // Limpio y sumo el precio\r\n\r\n            const productoElemento = document.createElement('div');\r\n            productoElemento.classList.add('compras_videojuego', 'entrar-izquierda');\r\n            productoElemento.id = `${producto.id}_${producto.plataforma}`;\r\n\r\n            productoElemento.innerHTML = `\r\n                <div class=\"videojuego_imagen\">\r\n                    <img src=\"images/${producto.imagen}\" alt=\"videojuego imagen\">\r\n                </div>\r\n                <div class=\"videojuego_contenido\">\r\n                    <h1 class=\"videojuego-titulo\">${producto.titulo}</h1>\r\n                    <p class=\"videojuego-precio\">Precio: ${producto.precio}</p>\r\n                    <p class=\"videojuego-plataforma\">${producto.plataforma}</p>\r\n                    <label for=\"cantidad_${producto.id}_${producto.plataforma}\" class=\"videojuego-cantidad\">Cantidad</label>\r\n                    <select name=\"cantidad_${producto.id}_${producto.plataforma}\">\r\n                        <option value=\"1\" selected>1</option>\r\n                        <option value=\"2\">2</option>\r\n                        <option value=\"3\">3</option>\r\n                        <option value=\"4\">4</option>\r\n                        <option value=\"5\">5</option>\r\n                        <option value=\"6\">6</option>\r\n                        <option value=\"7\">7</option>\r\n                        <option value=\"8\">8</option>\r\n                        <option value=\"9\">9</option>\r\n                    </select>\r\n                    <button \r\n                        class=\"boton-amarillo videojuego-eliminar\"\r\n                        data-id=\"${producto.id}_${producto.plataforma}\"\r\n                        onclick=\"eliminarDeLCarrito(this)\">\r\n                        Eliminar del carrito\r\n                    </button>\r\n                </div>\r\n            `;\r\n\r\n            carritoElemento.appendChild(productoElemento);\r\n        }\r\n    });\r\n\r\n    mostrarTotales(subtotal);\r\n}\r\n\r\nfunction mostrarTotales(subtotal) {\r\n    fetch(`calcular_iva.php?precio=${subtotal}`)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            const contenedorTotales = document.querySelector('.totales_contenedor');\r\n            if (!contenedorTotales) return;\r\n\r\n            contenedorTotales.innerHTML = `\r\n                <p>Subtotal: $${subtotal.toFixed(2)}</p>\r\n                <p>IVA (${(data.tasa_iva * 100).toFixed(0)}%): $${data.iva.toFixed(2)}</p>\r\n                <p><strong>Total: $${data.total.toFixed(2)}</strong></p>\r\n                <p><small>Pa√≠s detectado: ${data.pais}</small></p>\r\n            `;\r\n        })\r\n        .catch(error => {\r\n            console.error('Error al calcular IVA:', error);\r\n        });\r\n}\r\n"]}